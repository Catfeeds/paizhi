<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link rel="Bookmark" href="__ROOT__/favicon.ico" >
    <link rel="Shortcut Icon" href="__ROOT__/favicon.ico" />
    <!--[if lt IE 9]>
    <script type="text/javascript" src="__LIB__/html5.js"></script>
    <script type="text/javascript" src="__LIB__/respond.min.js"></script>
    <script type="text/javascript" src="__LIB__/PIE_IE678.js"></script>
    <![endif]-->
    <link href="__STATIC__/h-ui/css/H-ui.min.css" rel="stylesheet" type="text/css" />
    <link href="__STATIC__/h-ui.admin/css/H-ui.login.css" rel="stylesheet" type="text/css" />
    <!--[if IE 6]>
    <script type="text/javascript" src="__LIB__/DD_belatedPNG_0.0.8a-min.js" ></script>
    <script>DD_belatedPNG.fix('*');</script>
    <![endif]-->
    <title>派职网企业管理系统</title>
    <meta name="keywords" content="{$Think.config.site.keywords}">
    <meta name="description" content="{$Think.config.site.keywords}">
</head>
<body>
<!--<div class="header">
    <h1>校园管理系统</h1>
</div>-->

<div class="loginWraper">
    <div id="loginform" class="loginBox loginBox-register">
    	<div class="logo"><a href="http://127.0.0.1:8020/recruit/index.html"><img src="__STATIC__/images/logo.png"/></a></div>
    	<h1 class="login-company">企业注册</h1>
        <form class="form form-horizontal" action="{:url('Pub/evpi')}" method="post" id="form">
            <div class="row cl">
                <label class="form-label col-xs-3 col-ms-3" style="line-height: 36px;font-size: 20px;">手机号</label>
                <div class="formControls col-xs-6 col-ms-6">
                    <input name="phone" id="phone" type="text" placeholder="请输入手机号" class="input-text size-L" >
                </div>
                <div class="col-xs-3 col-ms-3"></div>
            </div>
            <div class="row cl">
                <label class="form-label col-xs-3 col-ms-3" style="line-height: 40px;font-size: 20px;">密码</label>
                <div class="formControls col-xs-6 col-ms-6">
                    <input name="pwd" id="pwd"  type="password" placeholder="密码" class="input-text size-L" >
                </div>
                <div class="col-xs-3 col-ms-3"></div>
            </div>
            <div class="row cl">
                <label class="form-label col-xs-3 col-ms-3" style="line-height: 40px;font-size: 20px;">确认密码</label>
                <div class="formControls col-xs-6 col-ms-6">
                    <input name="rpwd" id="rpwd" type="password" placeholder="确认密码" class="input-text size-L">
                </div>
                <div class="col-xs-3 col-ms-3"></div>
            </div>
            <!--<div class="row cl">-->
                <!--<div class="formControls col-xs-6 col-ms-6 col-xs-offset-3 col-ms-offset-3">-->
                    <!--<input name="captcha" class="input-text size-L" type="text" placeholder="验证码" style="width:100px;min-width: auto" datatype="*" nullmsg="请填写验证码">-->
                    <!--<img id="captcha" src="{:captcha_src()}" alt="验证码" title="点击刷新验证码" style="cursor:pointer;width: 150px;height: 40px">-->
                <!--</div>-->
                <!--<div class="col-xs-3 col-ms-3"></div>-->
            <!--</div>-->
            <div class="row cl">
                <div class="formControls col-xs-6 col-ms-6 col-xs-offset-3 col-ms-offset-3">
                    <input name="code" id="code" class="input-text size-L" type="text" placeholder="短信验证码" style="min-width: auto" >
                	<a href="javascript:;" class="sms-code" id="get_code">点击获取</a>
                </div>
                <div class="col-xs-3 col-ms-3"></div>
            </div>
            <div class="row cl">
                <div class="formControls col-xs-6 col-xs-offset-3">
                    <label for="online">
                        <input type="checkbox" name="online" id="online" checked>
                    	我已阅读派职网<a href="javascript:;" class="term-service">《服务条款》</a>
                    </label>
                </div>
            </div>
            <div class="row cl">
                <div class="formControls col-xs-6 col-xs-offset-3">
                    <input name="" type="submit" class="btn btn-success radius size-L mr-20" value="&nbsp;注&nbsp;&nbsp;&nbsp;&nbsp;册&nbsp;">
                    <input name="" type="reset" class="btn btn-default radius size-L" value="&nbsp;重&nbsp;&nbsp;&nbsp;&nbsp;置&nbsp;">
                </div>
            </div>
            <div class="row cl">
            	<div class="col-xs-9 col-ms-9">
            		<a href="{:url('Pub/login')}" class="register-company">已有账号，点击登录</a>
            	</div>
               <div class="col-xs-3 col-ms-3"></div>
            </div>
        </form>
    </div>
</div>
<!--<div class="footer">Copyright LXR by 校园管理系统</div>-->
<script type="text/javascript" src="__LIB__/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="__LIB__/layer/2.4/layer.js"></script>
<script type="text/javascript" src="__LIB__/Validform/5.3.2/Validform.min.js"></script>
<script>

    //全局变量
    var InterValObj; //timer变量，控制时间
    var curCount; //当前剩余秒数
    $(function () {
//        $("#captcha").click(function () {
//            $(this).attr("src","{:captcha_src()}?t="+new Date().getTime())
//        });

//        $("#form").Validform({
//            tiptype:2,
//            ajaxPost:true,
//            showAllError:true,
//            callback:function(ret){
//                if (ret.code){
//                    if (ret.msg == '验证码错误!'){
//                        $("#captcha").click();
//                        $("[name='captcha']").val('');
//                        layer.msg(ret.msg);
//                    } else {
//                        layer.alert(ret.msg);
//                    }
//                } else {
//                    layer.msg("注册成功！");
//                    location.href = '{$Request.get.callback ?: \\think\\Url::build("Index/index")}';
//                }
//            }
//        });


        //点击获取验证码按钮时，只对手机号进行验证
        $('#get_code').click(function(){
            var phone = $('#phone').val();//手机号码
            $.ajax({
                type:'post',//选择post方式提交
                url:"{:url('Pub/send')}",//将数据提交的页面
                data:{phone:phone},//传值
                success: function(data)
                {

                    var arr = JSON.parse(data);//解析json编码
                    var statusCode = arr.code;//传回来的状态码
                    //当状态码为2的时候，表示发送成功，其他值则直接显示错误提示
                    if(statusCode == 2){
                        layer.msg(arr.msg); //弹出发送成功提示
                        curCount = 60; //倒计时开始时间60s
                        $("#get_code").css("background-color", "#ccc");
                        $("#get_code").attr("disabled", "true");
                        $("#get_code").text("获取"+curCount+"秒");
                        //codes = data;
                        InterValObj = window.setInterval(SetRemainTime, 1000); //定时器，每隔一秒执行一次
                    }else{
                        layer.msg(arr.msg); //直接弹出错误提示
                    }

                }
            });


        });



        //当注册表单提交时
        $("#form").submit(function(){
            var phone = $('#phone').val(); //手机号码
            var pwd = $('#pwd').val();//密码
            var rpwd = $('#rpwd').val();//确认密码
            var code = $('#code').val(); //验证码

            //判断是否选中同意条款
            if($('#online').is(':checked')){
                var identified = '1'; //选中
            }else{
                var identified = '0'; //没选中
            }


            var bool = false;
            $.ajax({
                type:'post',//选择post方式提交
                url:"{:url('Pub/checkRegister')}", //将数据提交的页面
                data:{phone:phone,pwd:pwd,rpwd:rpwd,code:code,identified:identified},//传值
                async:false,//设置同步：好处是data可以在$.ajax外面取到，默认异步
                //dataType:'json',//设置json编码形式，不写默认返回的是文本形式(十分重要)
                success: function(data)
                {

                    var arr2 = JSON.parse(data);//解析json编码
                    var statusCode = arr2.code;//传回来的状态码
                    //当状态码为11的时候，表示注册成功，其他值则直接显示错误提示
                    if(statusCode == 11){
                        layer.msg(arr2.msg);
                        bool = true;
//                        window.location.href="{:url('pub/evpi')}?phone="+phone+"";

                    }else{
                        layer.msg(arr2.msg);  //直接弹出错误提示

                        bool = false;
                    }

                }

            });
            return bool;

        });



    });

    //定时器触发该函数
    function SetRemainTime()
    {
        if (curCount == 0) {
            window.clearInterval(InterValObj); //停止计时器
            $("#get_code").removeAttr("disabled"); //启用按钮
            $("#get_code").css("background-color", "");
            $("#get_code").text("重新发送");
            //codes = ""; //清除验证码。如果不清除，过时间后，输入收到的验证码依然有效
        }
        else {
            curCount--;
            $("#get_code").text("获取" + curCount + "秒");
        }
    }
</script>
</body>
</html>